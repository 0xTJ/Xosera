//
// copper - blend dual playfield test
//
                .list    false
                .include "../xosera_m68k_api/xosera_m68k_defs.inc"
                .macname false
                .listcond false
                .list    true

                export  hpos_sol,hpos_eol               ; export HPOS SOL/EOL offsets for 640/848 modes

.macro          hdelay
                HPOS    #0
                HPOS    #0
                HPOS    #0
                HPOS    #0
.endm

blend_start
hpos_sol_move   MOVE    #MOVE+vcolor_tbl,color_load     ; reset color table start

line_loop       MOVE    #$0000,XR_COLOR_A_ADDR+0        ; colorA[0] = black
                MOVE    #$0000,XR_COLOR_B_ADDR+0        ; colorB[0] = black
color_load      MOVE    vcolor_tbl,XR_COLOR_B_ADDR+0    ; set colorB[0] from table (self-modified)

                LDM     color_load                      ; load SETM opcode+source addr
                ADDI    #1                              ; increment
                CMPI    #MOVE+vcolor_end                ; test vs table end (with SETM opcode)
                BRLT    not_end                         ; branch if not past end
                LDI     #MOVE+vcolor_tbl                ; load reset SETM opcode+table start
not_end         STM     color_load                      ; store modified SETM opcode+source

hpos_sol        HPOS    #160-8

                MOVE    #$0000,XR_COLOR_A_ADDR+0
                hdelay
                MOVE    #$0F00,XR_COLOR_A_ADDR+0
                hdelay
                MOVE    #$00F0,XR_COLOR_A_ADDR+0
                hdelay
                MOVE    #$000F,XR_COLOR_A_ADDR+0
                hdelay
                MOVE    #$040C,XR_COLOR_A_ADDR+0
                hdelay
                MOVE    #$0FF0,XR_COLOR_A_ADDR+0
                hdelay
                MOVE    #$0FFF,XR_COLOR_A_ADDR+0
                hdelay
                MOVE    #$0F0F,XR_COLOR_A_ADDR+0
                hdelay

                MOVE    #$F000,XR_COLOR_A_ADDR+0

                MOVE    #$4000,XR_COLOR_A_ADDR+0
                hdelay
                MOVE    #$4F00,XR_COLOR_A_ADDR+0
                hdelay
                MOVE    #$40F0,XR_COLOR_A_ADDR+0
                hdelay
                MOVE    #$400F,XR_COLOR_A_ADDR+0
                hdelay
                MOVE    #$440C,XR_COLOR_A_ADDR+0
                hdelay
                MOVE    #$4FF0,XR_COLOR_A_ADDR+0
                hdelay
                MOVE    #$4FFF,XR_COLOR_A_ADDR+0
                hdelay
                MOVE    #$4F0F,XR_COLOR_A_ADDR+0
                hdelay

                MOVE    #$F000,XR_COLOR_A_ADDR+0

                MOVE    #$8000,XR_COLOR_A_ADDR+0
                hdelay
                MOVE    #$8F00,XR_COLOR_A_ADDR+0
                hdelay
                MOVE    #$80F0,XR_COLOR_A_ADDR+0
                hdelay
                MOVE    #$800F,XR_COLOR_A_ADDR+0
                hdelay
                MOVE    #$840C,XR_COLOR_A_ADDR+0
                hdelay
                MOVE    #$8FF0,XR_COLOR_A_ADDR+0
                hdelay
                MOVE    #$8FFF,XR_COLOR_A_ADDR+0
                hdelay
                MOVE    #$8F0F,XR_COLOR_A_ADDR+0
                hdelay

                MOVE    #$F000,XR_COLOR_A_ADDR+0

                MOVE    #$C000,XR_COLOR_A_ADDR+0
                hdelay
                MOVE    #$CF00,XR_COLOR_A_ADDR+0
                hdelay
                MOVE    #$C0F0,XR_COLOR_A_ADDR+0
                hdelay
                MOVE    #$C00F,XR_COLOR_A_ADDR+0
                hdelay
                MOVE    #$C40C,XR_COLOR_A_ADDR+0
                hdelay
                MOVE    #$CFF0,XR_COLOR_A_ADDR+0
                hdelay
                MOVE    #$CFFF,XR_COLOR_A_ADDR+0
                hdelay
                MOVE    #$0000,XR_COLOR_A_ADDR+0

hpos_eol        HPOS    #799                            ; wait for last pixel of line
                BRGE    line_loop                       ; branch always (since last write was A)

                VPOS    #$7FF                           ; wait for SOF (just in case)

vcolor_tbl
                word    $5000,$5100,$5200,$5300
                word    $5400,$5500,$5600,$5700
                word    $5800,$5900,$5A00,$5B00
                word    $5C00,$5D00,$5E00,$5F00

                word    $5000,$5010,$5020,$5030
                word    $5040,$5050,$5060,$5070
                word    $5080,$5090,$50A0,$50B0
                word    $50C0,$50D0,$50E0,$50F0

                word    $5000,$5001,$5002,$5003
                word    $5004,$5005,$5006,$5007
                word    $5008,$5009,$500A,$500B
                word    $500C,$500D,$500E,$500F

                word    $5000,$5111,$5222,$5333
                word    $5444,$5555,$5666,$5777
                word    $5888,$5999,$5AAA,$5BBB
                word    $5CCC,$5DDD,$5EEE,$5FFF

                word    $A000,$A100,$A200,$A300
                word    $A400,$A500,$A600,$A700
                word    $A800,$A900,$AA00,$AB00
                word    $AC00,$AD00,$AE00,$AF00

                word    $A000,$A010,$A020,$A030
                word    $A040,$A050,$A060,$A070
                word    $A080,$A090,$A0A0,$A0B0
                word    $A0C0,$A0D0,$A0E0,$A0F0

                word    $A000,$A001,$A002,$A003
                word    $A004,$A005,$A006,$A007
                word    $A008,$A009,$A00A,$A00B
                word    $A00C,$A00D,$A00E,$A00F

                word    $A000,$A111,$A222,$A333
                word    $A444,$A555,$A666,$A777
                word    $A888,$A999,$AAAA,$ABBB
                word    $ACCC,$ADDD,$AEEE,$AFFF

                word    $F000,$F100,$F200,$F300
                word    $F400,$F500,$F600,$F700
                word    $F800,$F900,$FA00,$FB00
                word    $FC00,$FD00,$FE00,$FF00

                word    $F000,$F010,$F020,$F030
                word    $F040,$F050,$F060,$F070
                word    $F080,$F090,$F0A0,$F0B0
                word    $F0C0,$F0D0,$F0E0,$F0F0

                word    $F000,$F001,$F002,$F003
                word    $F004,$F005,$F006,$F007
                word    $F008,$F009,$F00A,$F00B
                word    $F00C,$F00D,$F00E,$F00F

                word    $F000,$F111,$F222,$F333
                word    $F444,$F555,$F666,$F777
                word    $F888,$F999,$FAAA,$FBBB
                word    $FCCC,$FDDD,$FEEE,$FFFF

                word    $1000,$1101,$1202,$1303
                word    $1404,$1505,$1606,$1707
                word    $1808,$1909,$1A0A,$1B0B
                word    $1C0C,$1D0D,$1E0E,$1F0F

                word    $2000,$2101,$2202,$2303
                word    $2404,$2505,$2606,$2707
                word    $2808,$2909,$2A0A,$2B0B
                word    $2C0C,$2D0D,$2E0E,$2F0F

                word    $3000,$3101,$3202,$3303
                word    $3404,$3505,$3606,$3707
                word    $3808,$3909,$3A0A,$3B0B
                word    $3C0C,$3D0D,$3E0E,$3F0F

                word    $4000,$4101,$4202,$4303
                word    $4404,$4505,$4606,$4707
                word    $4808,$4909,$4A0A,$4B0B
                word    $4C0C,$4D0D,$4E0E,$4F0F

                word    $5000,$5101,$5202,$5303
                word    $5404,$5505,$5606,$5707
                word    $5808,$5909,$5A0A,$5B0B
                word    $5C0C,$5D0D,$5E0E,$5F0F

                word    $6000,$6101,$6202,$6303
                word    $6404,$6505,$6606,$6707
                word    $6808,$6909,$6A0A,$6B0B
                word    $6C0C,$6D0D,$6E0E,$6F0F

                word    $7000,$7101,$7202,$7303
                word    $7404,$7505,$7606,$7707
                word    $7808,$7909,$7A0A,$7B0B
                word    $7C0C,$7D0D,$7E0E,$7F0F

                word    $8000,$8101,$8202,$8303
                word    $8404,$8505,$8606,$8707
                word    $8808,$8909,$8A0A,$8B0B
                word    $8C0C,$8D0D,$8E0E,$8F0F

                word    $9000,$9101,$9202,$9303
                word    $9404,$9505,$9606,$9707
                word    $9808,$9909,$9A0A,$9B0B
                word    $9C0C,$9D0D,$9E0E,$9F0F

                word    $A000,$A101,$A202,$A303
                word    $A404,$A505,$A606,$A707
                word    $A808,$A909,$AA0A,$AB0B
                word    $AC0C,$AD0D,$AE0E,$AF0F

                word    $B000,$B101,$B202,$B303
                word    $B404,$B505,$B606,$B707
                word    $B808,$B909,$BA0A,$BB0B
                word    $BC0C,$BD0D,$BE0E,$BF0F

                word    $C000,$C101,$C202,$C303
                word    $C404,$C505,$C606,$C707
                word    $C808,$C909,$CA0A,$CB0B
                word    $CC0C,$CD0D,$CE0E,$CF0F

                word    $D000,$D101,$D202,$D303
                word    $D404,$D505,$D606,$D707
                word    $D808,$D909,$DA0A,$DB0B
                word    $DC0C,$DD0D,$DE0E,$DF0F

                word    $E000,$E101,$E202,$E303
                word    $E404,$E505,$E606,$E707
                word    $E808,$E909,$EA0A,$EB0B
                word    $EC0C,$ED0D,$EE0E,$EF0F

                word    $F000,$F101,$F202,$F303
                word    $F404,$F505,$F606,$F707
                word    $F808,$F909,$FA0A,$FB0B
                word    $FC0C,$FD0D,$FE0E,$FF0F
vcolor_end
                .end
